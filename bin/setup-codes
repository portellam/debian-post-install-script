#!/bin/false

#
# Filename:         setup-codes
# Description:      Helper functions to evaluate and preserve exit codes.
# Author(s):        Alex Portell <github.com/portellam>
# Maintainer(s):    Alex Portell <github.com/portellam>
#

# <functions>
    function SetParameters
    {
        if "${_ARE_PARAMS_SET_SETUP_CODES}"; then
            return 0
        fi

        declare -gr _ARE_PARAMS_SET_SETUP_CODES=true

        declare -ig _LAST_EXIT_CODE=0

        # <remarks> Functions can go here. </remarks>
        SetExitCode
    }

    function GetExitCode
    {
        if IsInt "${_LAST_EXIT_CODE}"; then
            return "${_LAST_EXIT_CODE}"
        fi
    }

    function GetFailExitCode
    {
        if [[ "${_LAST_EXIT_CODE}" -ne 0 ]]; then
            return 0
        fi

        return 1
    }

    function GetPassExitCode
    {
        if [[ "${_LAST_EXIT_CODE}" -ne 0 ]] \
            && ! GetSkipExitCode; then
            return 1
        fi

        return 0
    }

    function GetSkipExitCode
    {
        if [[ "${_LAST_EXIT_CODE}" -ne 255 ]]; then
            return 1
        fi

        return 0
    }

    function SetExitCode
    {
        _LAST_EXIT_CODE="${?}"
    }

    function SetPassExitCode
    {
        case "${?}" in
            0 | 255 )
                _LAST_EXIT_CODE=0 ;;

            * )
                _LAST_EXIT_CODE=1 ;;
        esac
    }
# </functions>

# <main>
    SetParameters
    unset SetParameters
# </main>