#!/bin/false

#
# Filename:         setup-prompts
# Description:      Prompts for user interaction and execution status.
# Author(s):        Alex Portell <github.com/portellam>
# Maintainer(s):    Alex Portell <github.com/portellam>
#

# <sources>
    source setup-codes
    source setup-common
# </sources>

# <functions>
    function AskToExecuteOrSkip
    {
        local OUTPUT=""

        if [[ ! -z "${1}" ]]; then
            OUTPUT="${1} "
        fi

        for COUNT in "${_COUNT_LIST[@]}"; do
            echo -en "${OUTPUT}[Y/n]: "
            read -r -p "" ANSWER

            case "${ANSWER}" in
                [Yy]* )
                    return 0 ;;

                [Nn]* )
                    return 255 ;;

                * )
                    echo "Please answer 'Y' or 'N'." ;;
            esac
        done

        return 1
    }

    function GetPromptsFromAnswerList
    {
        local -n ANSWER_LIST_REFERENCE="${1}"
        local -n PROMPT_REFERENCE="${2}"
        local -n WARNING_REFERENCE="${3}"
        PROMPT_REFERENCE=""
        WARNING_REFERENCE=""
        local -i LIST_MAX_INDEX=$( head -n 1 <<< $( sort -r <<< "${!ANSWER_LIST_REFERENCE[*]}" ) )

        for KEY in "${!ANSWER_LIST_REFERENCE[@]}"; do
            local ANSWER="${ANSWER_LIST_REFERENCE[$KEY]}"
            local FORMATTED_ANSWER="("$( echo ${ANSWER::1} | tr '[:lower:]' '[:upper:]' )")${ANSWER:1}"
            local FORMATTED_WARNING="'"$( echo ${ANSWER::1} | tr '[:lower:]' '[:upper:]' )'"'

            if [[ "${KEY}" -lt "${#LIST_MAX_INDEX[@]}" ]]; then
                PROMPT_REFERENCE+="${FORMATTED_ANSWER}/"
                WARNING_REFERENCE+="${FORMATTED_WARNING}, "
            else
                PROMPT_REFERENCE+="${FORMATTED_ANSWER}"
                WARNING_REFERENCE+="or ${FORMATTED_WARNING}."
            fi
        done

        PROMPT_REFERENCE="[${PROMPT_REFERENCE}]: "
        WARNING_REFERENCE="Please answer ${WARNING_REFERENCE}."
        return 0
    }

    function PrintPrefixPassOrFail
    {
        SetExitCode

        case "${_LAST_EXIT_CODE}" in
            0 )
                echo -en "${_PREFIX_PASS}" ;;

            255 )
                echo -en "${_PREFIX_SKIP}" ;;

            * )
                echo -en "${_PREFIX_FAIL}" ;;
        esac

        if [[ -z "${1}" ]]; then
            echo
        else
            echo -e " ${1}"
        fi

        return "${_LAST_EXIT_CODE}"
    }

    function PrintSuffixPassOrFail
    {
        SetExitCode

        if [[ ! -z "${1}" ]]; then
            echo -en "${1}\t"
        fi

        case "${_LAST_EXIT_CODE}" in
            0 )
                echo -e "${_SUFFIX_PASS}" ;;

            255 )
                echo -e "${_SUFFIX_SKIP}" ;;

            * )
                echo -e "${_SUFFIX_FAIL}" ;;
        esac

        return "${_LAST_EXIT_CODE}"
    }

    function PrintSuffixWait
    {
        if [[ ! -z "${1}" ]]; then
            echo -en "${1}\t"
        fi

        echo -e "${_SUFFIX_WORK}"
        return 0
    }
# </functions>